{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inbox â€” SnoozeNot</title>

<style>
    body { background: #000; color: #eaeaea; font-family: "Inter", sans-serif; margin:0; padding:25px; }
    .container { max-width: 1200px; margin:0 auto; }
    h1 { color: #ff6600; font-size:2rem; font-weight:700; margin-bottom:25px; border-bottom:2px solid #1e1e1e; padding-bottom:10px; }

    table { width:100%; border-collapse:collapse; border-radius:8px; overflow:hidden; background:#0d0d0d; }
    th { background:#1b1b1b; padding:14px 10px; text-transform:uppercase; font-size:0.8rem; color:#bbb; }
    td { padding:14px 10px; border-bottom:1px solid #1b1b1b; }
    tr:hover { background:#121212; }

    input[type="checkbox"] { accent-color:#ff6600; width:18px; height:18px; }

    .status-work { color:#ff6600; font-weight:600; }
    .status-study { color:#4aa3ff; font-weight:600; }
    .status-personal { color:#33cc33; font-weight:600; }
    .status-others { color:#ff33aa; font-weight:600; }

    .action-button { background:transparent; border:none; color:#ff6600; font-size:0.9rem; cursor:pointer; text-decoration:none; }
    .action-button:hover { text-decoration:underline; }

    .btn-back-dashboard { display:inline-block; margin-top:25px; padding:10px 16px; background:#ff6600; border:1px solid #ff6600; color:#000; border-radius:6px; font-weight:600; text-decoration:none; transition:0.2s; }
    .btn-back-dashboard:hover { background:#e65a00; border-color:#e65a00; }
</style>
</head>

<body>
<div class="container">

<h1>Inbox</h1>

<table>
<thead>
<tr>
    <th>Done</th>
    <th>Task</th>
    <th>Start Time</th>
    <th>End Time</th>
    <th>Category</th>
    <th>Actions</th>
</tr>
</thead>

<tbody>
{% for task in tasks %}
<tr>
    <td>
        <input type="checkbox" {% if task.completed %}checked{% endif %} onclick="toggleTask({{ task.id }})">
    </td>

    <td>{{ task.title }}</td>

    <!-- Start Time -->
    <td>
    {% if task.created_at %}
        {{ task.created_at|date:"M d, Y H:i" }}
    {% else %}
        <span style="color:#888;">No date</span>
    {% endif %}
</td>

    <!-- Due Date -->
<td>
    {% if task.due_time %}
        {{ task.due_time|date:"M d, Y H:i" }}
    {% else %}
        <span style="color:#888;">No date</span>
    {% endif %}
</td>

    <td class="status-{{ task.categories|lower }}">{{ task.categories|title }}</td>

    <td>
        <a href="{% url 'UserAuth:todo_list' %}?edit={{ task.id }}" class="action-button">Edit</a>
        <button class="action-button" onclick="deleteTask({{ task.id }})">Delete</button>
    </td>
</tr>
{% empty %}
<tr>
    <td colspan="6" style="text-align:center; font-style:italic;">No tasks yet.</td>
</tr>
{% endfor %}
</tbody>
</table>

<a href="{% url 'UserAuth:Dashboard' %}" class="btn-back-dashboard">Dashboard</a>
</div>

<script>
function deleteTask(taskId) {
    if(!confirm("Delete this task?")) return;
    fetch("{% url 'UserAuth:delete_task' 0 %}".replace('0', taskId), {
        method:"POST",
        headers:{"X-CSRFToken":"{{ csrf_token }}","Content-Type":"application/json"},
        body: JSON.stringify({})
    }).then(res=>res.json()).then(data=>{if(data.ok) location.reload();});
}

function toggleTask(taskId) {
    fetch("{% url 'UserAuth:toggle_task' 0 %}".replace('0', taskId), {
        method:"POST",
        headers:{"X-CSRFToken":"{{ csrf_token }}","Content-Type":"application/json"},
        body: JSON.stringify({})
    }).then(res=>res.json()).then(data=>{if(data.ok) location.reload();});
}
</script>

</body>
</html>
